<%- include('partials/header') %>
<%- include('partials/flash') %>

<div class="wrap doctor-search">
  <header class="page-header">
    <p class="eyebrow">Find a doctor</p>
    <h1>Book the right doctor for you</h1>
    <p class="page-subtitle">
      Search by name, specialty, or area. Only approved doctors appear here.
    </p>
  </header>

  <form method="get" action="/doctors" class="doctor-filters">
    <input
      type="text"
      name="q"
      placeholder="Search name or specialty…"
      value="<%= q || '' %>"
    />
    <input
      type="text"
      name="area"
      placeholder="Area (e.g. Dhanmondi)"
      value="<%= area || '' %>"
    />
    <input
      type="number"
      name="maxFee"
      placeholder="Max fee"
      value="<%= maxFee || '' %>"
    />
    <button type="submit" class="btn primary">Search</button>
    <% if (q || area || maxFee) { %>
      <a href="/doctors" class="btn ghost">Reset</a>
    <% } %>
  </form>

  <% if (!rows.length) { %>
    <p class="empty">No doctors found. Try changing your search.</p>
  <% } %>

  <div class="doctor-grid">
    <% rows.forEach(d => { %>
      <article class="doctor-card">
        <% if (d.photo_url) { %>
          <div class="doctor-card__photo">
            <img src="<%= d.photo_url %>" alt="Photo of <%= d.name %>" />
          </div>
        <% } %>
        <div class="doctor-card__body">
          <h2>
            <a href="/doctors/<%= d.did %>" class="doctor-card__name-link">
              <%= d.name %>
            </a>
          </h2>
          <p class="doctor-card__meta">
            <span><%= d.specialty || 'General physician' %></span>
            <% if (d.area) { %> · <span><%= d.area %></span><% } %>
          </p>
          <p class="doctor-card__fee">
            <%= d.fee ? ('৳ ' + d.fee + ' per visit') : 'Fee on request' %>
          </p>
          <div class="doctor-card__actions">
            <a href="/doctors/<%= d.did %>" class="btn ghost">View profile</a>
            <a href="/book?doctorId=<%= d.uid %>" class="btn primary">Book</a>
          </div>
        </div>
      </article>
    <% }) %>
  </div>
</div>

<%- include('_footer') %>
