<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Doctor Dashboard</title>
    <link rel="stylesheet" href="/css/style.css">
  </head>
  <body>
    <%- include('_header') %><%- include('_flash') %>
    <div class="wrap">
    <h2>Todayâ€™s Queue</h2>
    <table>
      <tr>
        <th>Time</th><th>Patient</th><th>Status</th><th>Room</th><th>Actions</th>
      </tr>
      <% rows.forEach(r=>{ %>
      <tr>
        <td><%= r.slot_time %></td>
        <td><%= r.patient_name %></td>
        <td>
          <%= r.status %>
          <% if(r.status==='called'){ %> (since <%= r.called_at||'' %>) <% } %>
          <% if(r.status==='in_progress'){ %> (since <%= r.started_at||'' %>) <% } %>
        </td>
        <td>
          <form method="post" action="/doctor/appointments/<%= r.id %>/room">
            <input name="room" value="<%= r.room||'' %>" placeholder="Room #">
            <button>Save</button>
          </form>
        </td>
        <td style="white-space:nowrap">
          <form method="post" action="/doctor/appointments/<%= r.id %>/call" style="display:inline"><button>Call</button></form>
          <form method="post" action="/doctor/appointments/<%= r.id %>/start" style="display:inline"><button>Start</button></form>
          <form method="post" action="/doctor/appointments/<%= r.id %>/done" style="display:inline"><button>Done</button></form>
          <form method="post" action="/doctor/appointments/<%= r.id %>/noshow" style="display:inline"><button>No-show</button></form>
        </td>
      </tr>
      <% }) %>
    </table>
    </div>
    <%- include('_footer') %>
  </body>
</html>
