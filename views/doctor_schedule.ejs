<%- include('partials/header') %>
<%- include('partials/flash') %>

<div class="wrap doctor-schedule-page">
  <header class="page-header">
    <p class="eyebrow">Doctor</p>
    <h1>Schedule</h1>
    <p class="page-subtitle">
      Define when you are available for appointments at each clinic.
    </p>
  </header>

  <section class="doctor-schedule-layout">
    <div class="card">
      <h2 class="section-title">Select clinic</h2>
      <form method="get" action="/doctor/schedule" class="schedule-clinic-form">
        <label>Clinic</label>
        <select name="clinicId" onchange="this.form.submit()">
          <% clinics.forEach(c=>{ %>
            <option value="<%= c.id %>" <%= c.id==clinicId?'selected':'' %>><%= c.name %> â€” <%= c.area||'' %></option>
          <% }) %>
        </select>
      </form>
    </div>
  </section>

  <section class="doctor-schedule-form">
    <div class="card">
      <h2 class="section-title">Weekly availability</h2>
      <form method="post" action="/doctor/schedule" class="schedule-form">
        <%- include('partials/csrf') %>
        <input type="hidden" name="clinicId" value="<%= clinicId %>">
        <table class="schedule-table">
          <thead>
            <tr>
              <th>Day</th>
              <th>Start (HH:MM)</th>
              <th>End (HH:MM)</th>
            </tr>
          </thead>
          <tbody>
            <% const days=['Sun','Mon','Tue','Wed','Thu','Fri','Sat']; for(let d=0; d<=6; d++){ const r=map[d]||{}; %>
              <tr>
                <td><%= days[d] %></td>
                <td><input name="s_<%= d %>" value="<%= r.start_time||'' %>" placeholder="10:00"></td>
                <td><input name="e_<%= d %>" value="<%= r.end_time||'' %>" placeholder="12:00"></td>
              </tr>
            <% } %>
          </tbody>
        </table>
        <div class="clinic-form__actions">
          <button type="submit" class="btn primary">Save schedule</button>
          <a class="btn ghost" href="/doctor/clinics">Back</a>
        </div>
      </form>
    </div>
  </section>
</div>

<%- include('_footer') %>
